–§—ñ–Ω–∞–ª—å–Ω–∏–π –ø—Ä–æ—î–∫—Ç –∑ –∫—É—Ä—Å—É





Ôªø–ß–∞—Å—Ç–∏–Ω–∞ 1. Building an End-to-End Streaming Pipeline



–ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

 üëâüèª–û—Ç–∂–µ, –≤–∏ –≤–∂–µ –∑–Ω–∞—î—Ç–µ —É–º–æ–≤–∏ –∑–∞–≤–¥–∞–Ω–Ω—è. –í–∏—Å–≤—ñ—Ç–ª–∏–º–æ —ó—Ö –¥–æ–∫–ª–∞–¥–Ω—ñ—à–µ.


–í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ –±—É–∫–º–µ–∫–µ—Ä—Å—å–∫—ñ–π –∫–æ–Ω—Ç–æ—Ä—ñ. –û–¥–Ω–µ –∑ –≤–∞—à–∏—Ö –∑–∞–≤–¥–∞–Ω—å ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –¥–ª—è ML-–º–æ–¥–µ–ª–µ–π. –î–µ—è–∫—ñ –∑ features ‚Äî —Ü–µ —Å–µ—Ä–µ–¥–Ω—ñ–π –∑—Ä—ñ—Å—Ç, —Å–µ—Ä–µ–¥–Ω—è –≤–∞–≥–∞, —Å—Ç–∞—Ç—å, –∫—Ä–∞—ó–Ω–∞ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∞—Ç–ª–µ—Ç—ñ–≤.

–ú–æ–¥–µ–ª—ñ —Ç—Ä–µ–Ω—É—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏–¥—É —Å–ø–æ—Ä—Ç—É. –î–∞–Ω—ñ –ø—Ä–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –º–µ–¥–∞–ª—ñ —É –≤–∏—Å—Ç—É–ø—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —è–∫ target (output) –¥–ª—è ML-–º–æ–¥–µ–ª—ñ.

–§—ñ—Ä–º–∞ —Ö–æ—á–µ –∫–æ—Ä–∏–≥—É–≤–∞—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Å—Ç–∞–≤–æ–∫ —è–∫–æ–º–æ–≥–∞ —à–≤–∏–¥—à–µ, —Ç–æ–º—É –≤–∞—Å –ø–æ–ø—Ä–æ—Å–∏–ª–∏ —Ä–æ–∑—Ä–æ–±–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Å—Ç—Ä–∏–º—ñ–Ω–≥—É. –§—ñ–∑–∏—á–Ω—ñ –¥–∞–Ω—ñ –∞—Ç–ª–µ—Ç—ñ–≤ –≤—ñ–¥–æ–º—ñ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å —ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ MySQL –±–∞–∑—ñ –¥–∞–Ω–∏—Ö. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–º–∞–≥–∞–Ω—å –∂–µ –ø–æ–¥–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ Kafka-—Ç–æ–ø—ñ–∫.



–í–∞—à–∞ –∑–∞–¥–∞—á–∞:

1. –ó—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ —Ñ—ñ–∑–∏—á–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –∞—Ç–ª–µ—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Spark –∑ MySQL —Ç–∞–±–ª–∏—Ü—ñ olympic_dataset.athlete_bio (–±–∞–∑–∞ –¥–∞–Ω–∏—Ö —ñ Credentials –¥–æ –Ω–µ—ó –≤–∞–º –±—É–¥—É—Ç—å –Ω–∞–¥–∞–Ω—ñ).



2. –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ, –¥–µ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∑—Ä–æ—Å—Ç—É —Ç–∞ –≤–∞–≥–∏ —î –ø–æ—Ä–æ–∂–Ω—ñ–º–∏ –∞–±–æ –Ω–µ —î —á–∏—Å–ª–∞–º–∏. –ú–æ–∂–Ω–∞ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏ –Ω–∞ –±—É–¥—å-—è–∫–æ–º—É –µ—Ç–∞–ø—ñ –≤–∞—à–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏.



3. –ó—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –∑ mysql —Ç–∞–±–ª–∏—Ü—ñ athlete_event_results —ñ –∑–∞–ø–∏—Å–∞—Ç–∏ –≤ –∫–∞—Ñ–∫–∞ —Ç–æ–ø—ñ–∫ athlete_event_results. –ó—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∑–º–∞–≥–∞–Ω—å –∑ Kafka-—Ç–æ–ø—ñ–∫—É athlete_event_results. –î–∞–Ω—ñ –∑ json-—Ñ–æ—Ä–º–∞—Ç—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ dataframe-—Ñ–æ—Ä–º–∞—Ç, –¥–µ –∫–æ–∂–Ω–µ –ø–æ–ª–µ json —î –æ–∫—Ä–µ–º–æ—é –∫–æ–ª–æ–Ω–∫–æ—é.



4. –û–±‚Äô—î–¥–Ω–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∑–º–∞–≥–∞–Ω—å –∑ Kafka-—Ç–æ–ø—ñ–∫—É –∑ –±—ñ–æ–ª–æ–≥—ñ—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –∑ MySQL —Ç–∞–±–ª–∏—Ü—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª—é—á–∞ athlete_id.





5. –ó–Ω–∞–π—Ç–∏ —Å–µ—Ä–µ–¥–Ω—ñ–π –∑—Ä—ñ—Å—Ç —ñ –≤–∞–≥—É –∞—Ç–ª–µ—Ç—ñ–≤ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏–¥—É —Å–ø–æ—Ä—Ç—É, —Ç–∏–ø—É –º–µ–¥–∞–ª—ñ –∞–±–æ —ó—ó –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ, —Å—Ç–∞—Ç—ñ, –∫—Ä–∞—ó–Ω–∏ (country_noc). –î–æ–¥–∞–π—Ç–µ —Ç–∞–∫–æ–∂ timestamp, –∫–æ–ª–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ –±—É–ª–∏ –∑—Ä–æ–±–ª–µ–Ω—ñ.



6. –ó—Ä–æ–±—ñ—Ç—å —Å—Ç—Ä–∏–º –¥–∞–Ω–∏—Ö (–∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó forEachBatch) —É:

–∞) –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–∞—Ñ–∫–∞-—Ç–æ–ø—ñ–∫,

b) –±–∞–∑—É –¥–∞–Ω–∏—Ö.

–ß–∞—Å—Ç–∏–Ω–∞ 2. Building an End-to-End Batch Data Lake



–ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

üëâüèª –ù–∞–≥–∞–¥–∞—î–º–æ —Å—É—Ç—å –∑–∞–≤–¥–∞–Ω–Ω—è
–£ —Ü—ñ–π —á–∞—Å—Ç–∏–Ω—ñ –ø—Ä–æ—î–∫—Ç—É –≤–∏ —Å—Ç–≤–æ—Ä–∏—Ç–µ –ø—Ä–æ—Å—Ç–∏–π multi-hop datalake, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫—ñ —è–∫ Spark, –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏ —Ç–∞ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó ETL-–ø—Ä–æ—Ü–µ—Å—ñ–≤ (Extract, Transform, Load).

–ó–∞–¥–∞—á–∞ –±—É–¥–µ —Å—Ö–æ–∂–∞ –¥–æ —Ç–æ—ó, —è–∫—É –≤–∏ —Ä–æ–∑–≤‚Äô—è–∑—É–≤–∞–ª–∏ –≤ –ø–µ—Ä—à–æ–º—É —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É –ø—Ä–æ—î–∫—Ç—ñ, –∞–ª–µ —Ü—å–æ–≥–æ —Ä–∞–∑—É –≤–∏ –±—É–¥–µ—Ç–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –±–∞—Ç—á–∞–º–∏ –¥–∞–Ω–∏—Ö, —â–æ —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –±—É–¥—å-—è–∫–æ—ó Data Engineering —Å–∏—Å—Ç–µ–º–∏.

–£ —Ö–æ–¥—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è –≤–∏ –±—É–¥–µ—Ç–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —É–∂–µ –≤—ñ–¥–æ–º–∏–º–∏ –≤–∞–º –¥–∞–Ω–∏–º–∏ –ø—Ä–æ –∞—Ç–ª–µ—Ç—ñ–≤ —Ç–∞ —ó—Ö–Ω—ñ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏. –¶–µ —Ç–∞–±–ª–∏—Ü—ñ athlete_bio —Ç–∞ athlete_event_results, —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –Ω–∞ FTP-—Å–µ—Ä–≤–µ—Ä—ñ –∑–∞ –∞–¥—Ä–µ—Å–∞–º–∏ https://ftp.goit.study/neoversity/athlete_bio.txt —ñ https://ftp.goit.study/neoversity/athlete_event_results.txt –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.

–û—Å–Ω–æ–≤–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è –ø–æ–ª—è–≥–∞—î –≤ –ø–æ–±—É–¥–æ–≤—ñ —Ç—Ä–∏—Ä—ñ–≤–Ω–µ–≤–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö: –≤—ñ–¥ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è (landing zone), —á–µ—Ä–µ–∑ –æ–±—Ä–æ–±–ª–µ–Ω—ñ —Ç–∞ –æ—á–∏—â–µ–Ω—ñ –¥–∞–Ω—ñ (bronze/silver), –¥–æ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É (gold).



–í–∞—à–∞ –∑–∞–¥–∞—á–∞:



1. –ù–∞–ø–∏—Å–∞—Ç–∏ —Ñ–∞–π–ª landing_to_bronze.py. –í—ñ–Ω –º–∞—î:

–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ñ–∞–π–ª –∑ ftp-—Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ csv,
–∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Spark –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ csv-—Ñ–∞–π–ª —ñ –∑–±–µ—Ä–µ–≥—Ç–∏ –π–æ–≥–æ —É —Ñ–æ—Ä–º–∞—Ç—ñ parquet —É –ø–∞–ø–∫—É bronze/{table}, –¥–µ {table} ‚Äî —ñ–º‚Äô—è —Ç–∞–±–ª–∏—Ü—ñ.


2. –ù–∞–ø–∏—Å–∞—Ç–∏ —Ñ–∞–π–ª bronze_to_silver.py. –í—ñ–Ω –º–∞—î:

–∑—á–∏—Ç—É–≤–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é bronze,
–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é —á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç—É –¥–ª—è –≤—Å—ñ—Ö —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –∫–æ–ª–æ–Ω–æ–∫,
—Ä–æ–±–∏—Ç–∏ –¥–µ–¥—É–±–ª—ñ–∫–∞—Ü—ñ—é —Ä—è–¥–∫—ñ–≤,
–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é –≤ –ø–∞–ø–∫—É silver/{table}, –¥–µ {table} ‚Äî —ñ–º‚Äô—è —Ç–∞–±–ª–∏—Ü—ñ.


3. –ù–∞–ø–∏—Å–∞—Ç–∏ —Ñ–∞–π–ª silver_to_gold.py. –í—ñ–Ω –º–∞—î:

–∑—á–∏—Ç—É–≤–∞—Ç–∏ –¥–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ: silver/athlete_bio —Ç–∞ silver/athlete_event_results,
—Ä–æ–±–∏—Ç–∏ join –∑–∞ –∫–æ–ª–æ–Ω–∫–æ—é athlete_id,
–¥–ª—è –∫–æ–∂–Ω–æ—ó –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó —Ü–∏—Ö 4 —Å—Ç–æ–≤–ø—á–∏–∫—ñ–≤ ‚Äî sport, medal, sex, country_noc ‚Äî –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ —Å–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è weight —ñ height,
–¥–æ–¥–∞—Ç–∏ –∫–æ–ª–æ–Ω–∫—É timestamp –∑ —á–∞—Å–æ–≤–æ—é –º—ñ—Ç–∫–æ—é –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏,
–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –≤ gold/avg_stats.


4. –ù–∞–ø–∏—Å–∞—Ç–∏ —Ñ–∞–π–ª project_solution.py, –¥–µ –±—É–¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏—Å—å Airflow DAG, —è–∫–∏–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç–∏–º–µ –≤—Å—ñ —Ç—Ä–∏ —Ñ–∞–π–ª–∏.
